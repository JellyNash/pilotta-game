/* Import accessibility styles - must come first */
@import './accessibility/accessibility.css';

/* Import responsive system */
@import './layouts/responsive.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #0f172a;
  color: #f1f5f9;
  overflow: hidden;
}

#root {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

/* ==================== GAME CONTAINMENT ==================== */
.app {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.game-header {
  flex-shrink: 0;
  height: auto;
  min-height: 4rem;
  max-height: 5rem;
  padding: 0.5rem;
  background-color: rgba(15, 23, 42, 0.9);
  z-index: 100;
}

.game-content {
  flex: 1;
  overflow: hidden;
  position: relative;
  height: calc(100vh - 5rem);
}

/* Game table must contain all elements */
#table {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
}

/* Player area containment */
.player-hand {
  contain: layout;
  overflow: visible;
}

/* Ensure south player cards are always visible */
.player-hand[data-position="south"] {
  z-index: 20;
  padding-bottom: 0.5rem;
}

/* ==================== ENHANCED CARD STYLES ==================== */
.playing-card {
  transition: transform 0.15s ease, box-shadow 0.15s ease;
  position: relative;
  display: flex;
  flex-direction: column;
  contain: style layout;
  background-color: white;
  border: 1px solid #e5e7eb;
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

/* Card visibility improvements */
.playing-card[data-face-down="false"] {
  background-color: white !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* Enhanced text visibility */
.playing-card .text-red-600 {
  color: #dc2626;
  font-weight: 900;
  text-shadow: 0 0 1px rgba(220, 38, 38, 0.3);
}

.playing-card .text-gray-900 {
  color: #111827;
  font-weight: 900;
  text-shadow: 0 0 1px rgba(17, 24, 39, 0.3);
}

/* Card selection and hover states */
.playing-card.ring-4 {
  box-shadow: 0 0 0 4px currentColor, 0 10px 15px rgba(0, 0, 0, 0.2);
}

.playing-card:hover {
  z-index: 100 !important;
  transform: translateY(-4px) translateZ(0);
}

/* Performance optimizations */
.card-wrapper {
  contain: style layout;
  will-change: transform;
}

.cards-container {
  contain: style layout;
  transform: translateZ(0);
}

/* ==================== RESPONSIVE CARD CONTAINERS ==================== */

/* Horizontal hands (north/south) */
.player-hand[data-position="north"],
.player-hand[data-position="south"] {
  width: 100%;
  max-width: min(90vw, 900px);
  margin: 0 auto;
}

.player-hand[data-position="north"] .cards-container,
.player-hand[data-position="south"] .cards-container {
  max-width: 100%;
  justify-content: center;
}

/* Vertical hands (east/west) */
.player-hand[data-position="east"],
.player-hand[data-position="west"] {
  height: 100%;
  max-height: min(70vh, 600px);
  margin: auto 0;
}

.player-hand[data-position="east"] .cards-container,
.player-hand[data-position="west"] .cards-container {
  max-height: 100%;
  justify-content: center;
}

/* ==================== RESPONSIVE GAME LAYOUT ==================== */

/* Desktop and larger tablets */
@media (min-width: 1024px) {
  /* North player area */
  .h-1\/4:first-child {
    height: 22%;
  }
  
  /* South player area - more space for human player */
  .h-1\/4:last-child {
    height: 25%;
  }
  
  /* Side players */
  .w-1\/4 {
    width: 22%;
  }
}

/* Tablets */
@media (max-width: 1023px) and (min-width: 768px) {
  .game-header {
    min-height: 3.5rem;
    max-height: 4rem;
  }
  
  .h-1\/4:first-child {
    height: 20%;
  }
  
  .h-1\/4:last-child {
    height: 26%;
  }
  
  .w-1\/4 {
    width: 20%;
  }
}

/* Mobile devices */
@media (max-width: 767px) {
  .game-header {
    min-height: 3rem;
    max-height: 3.5rem;
    padding: 0.25rem;
  }
  
  .game-header button {
    padding: 0.5rem;
  }
  
  .game-header svg {
    width: 1.25rem;
    height: 1.25rem;
  }
  
  /* Adjust player areas for mobile */
  .h-1\/4:first-child {
    height: 18%;
  }
  
  .h-1\/4:last-child {
    height: 28%;
  }
  
  .w-1\/4 {
    width: 18%;
  }
  
  /* Center play area gets more space */
  .flex-1 {
    flex: 1 1 64%;
  }
}

/* Small mobile screens */
@media (max-width: 480px) {
  .h-1\/4:first-child {
    height: 16%;
  }
  
  .h-1\/4:last-child {
    height: 30%;
  }
  
  .w-1\/4 {
    width: 15%;
  }
  
  .flex-1 {
    flex: 1 1 70%;
  }
  
  /* Smaller card overlap on tiny screens */
  .player-hand .cards-container {
    gap: 0;
  }
}

/* ==================== CARD SIZE CONSTRAINTS ==================== */

/* Maximum card sizes to prevent overflow */
.playing-card {
  max-width: 100px;
  max-height: 140px;
}

@media (max-width: 768px) {
  .playing-card {
    max-width: 80px;
    max-height: 110px;
  }
}

@media (max-width: 480px) {
  .playing-card {
    max-width: 70px;
    max-height: 95px;
  }
}

/* ==================== TRICK AREA RESPONSIVE ==================== */
.trick-area {
  max-width: min(80vw, 400px);
  max-height: min(40vh, 300px);
  margin: 0 auto;
}

@media (max-width: 768px) {
  .trick-area {
    transform: scale(0.85);
  }
}

@media (max-width: 480px) {
  .trick-area {
    transform: scale(0.7);
  }
}

/* ==================== BIDDING INTERFACE ==================== */
/* Removed old positioning styles - bidding interface now handles its own centering */

/* Touch target sizing for accessibility */
.touch-target {
  min-width: 44px;
  min-height: 44px;
}

/* Smooth number transitions */
.tabular-nums {
  font-variant-numeric: tabular-nums;
}

/* Button press effects */
.active\:shadow-inner:active {
  box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
}

/* ==================== Z-INDEX MANAGEMENT ==================== */
:root {
  --z-card-base: 10;
  --z-card-hover: 100;
  --z-card-selected: 90;
  --z-player-indicator: 20;
  --z-ui-overlay: 50;
  --z-modal: 100;
  --z-header: 100;
}

/* ==================== ACCESSIBILITY ==================== */

/* Focus styles */
.playing-card:focus-visible {
  outline: 3px solid #3b82f6;
  outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .playing-card[data-face-down="false"] {
    border: 2px solid WindowText;
    background: Window;
  }
  
  .playing-card[data-face-down="true"] {
    background: WindowText;
    border: 2px solid Window;
  }
  
  .playing-card .text-red-600 {
    color: WindowText;
    font-weight: 900;
  }
  
  .playing-card .text-gray-900 {
    color: WindowText;
    font-weight: 900;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .playing-card {
    transition: none !important;
  }
  
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Force hardware acceleration for smooth animations */
.animate-smooth {
  transform: translateZ(0);
  will-change: transform, opacity;
}

/* Optimize menu animations */
.menu-transition {
  transition: transform 0.2s ease, opacity 0.2s ease;
  transform: translateZ(0);
}

/* ==================== COLORBLIND SUPPORT ==================== */
.suit-hearts {
  color: #e11d48;
  font-weight: 900;
}

.suit-diamonds {
  color: #f97316;
  font-weight: 900;
}

.suit-clubs {
  color: #059669;
  font-weight: 900;
}

.suit-spades {
  color: #1e40af;
  font-weight: 900;
}

/* Pattern overlays for colorblind mode */
.suit-pattern-hearts::after {
  content: '♥';
  position: absolute;
  opacity: 0.1;
  font-size: 2em;
  transform: rotate(-15deg);
}

.suit-pattern-diamonds::after {
  content: '♦';
  position: absolute;
  opacity: 0.1;
  font-size: 2em;
  transform: rotate(15deg);
}

.suit-pattern-clubs::after {
  content: '♣';
  position: absolute;
  opacity: 0.1;
  font-size: 2em;
  transform: rotate(-15deg);
}

.suit-pattern-spades::after {
  content: '♠';
  position: absolute;
  opacity: 0.1;
  font-size: 2em;
  transform: rotate(15deg);
}

/* ==================== CSS VARIABLES ==================== */
:root {
  --card-size: 100;
  --font-size: 100;
  --animation-speed: 1;
}

/* Performance: Disable expensive effects on low-end devices */
@media (max-width: 768px), (max-height: 600px) {
  .backdrop-blur-md {
    backdrop-filter: none;
    background-color: rgba(30, 41, 59, 0.95) !important;
  }
  
  .backdrop-blur-lg {
    backdrop-filter: none;
    background-color: rgba(30, 41, 59, 0.98) !important;
  }
  
  .shadow-2xl {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
  }
}

/* ==================== UTILITY CLASSES ==================== */
.skip-link {
  position: absolute;
  left: -9999px;
  z-index: 999;
  padding: 1rem;
  background-color: #1e40af;
  color: white;
  text-decoration: none;
}

.skip-link:focus {
  left: 50%;
  transform: translateX(-50%);
  top: 1rem;
}

/* Prevent text selection during gameplay */
.game-content {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* Allow text selection in modals */
.modal-content {
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .playing-card {
    -webkit-tap-highlight-color: transparent;
  }
  
  .playing-card:active {
    transform: scale(0.98);
  }
}

/* Print styles */
@media print {
  body {
    background: white;
    color: black;
  }
  
  .game-header,
  .skip-link,
  button {
    display: none !important;
  }
  
  .playing-card {
    break-inside: avoid;
    page-break-inside: avoid;
  }
}